<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="CLASS" height="466px" preserveAspectRatio="none" style="width:785px;height:466px;background:#FFFFFF;" version="1.1" viewBox="0 0 785 466" width="785px" zoomAndPan="magnify"><defs/><g><!--class Auth--><g class="entity" data-entity="Auth" data-source-line="9" data-uid="ent0002" id="entity_Auth"><rect fill="#FFFFFF" height="278.8359" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="377.7021" x="220.48" y="7"/><ellipse cx="388.9448" cy="23" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M391.418,29.1431 Q390.8369,29.4419 390.1978,29.5913 Q389.5586,29.7407 388.853,29.7407 Q386.3462,29.7407 385.0264,28.0889 Q383.7066,26.437 383.7066,23.3159 Q383.7066,20.1865 385.0264,18.5347 Q386.3462,16.8828 388.853,16.8828 Q389.5586,16.8828 390.2061,17.0322 Q390.8535,17.1816 391.418,17.4805 L391.418,20.2031 Q390.7871,19.6221 390.1936,19.3523 Q389.6001,19.0825 388.9693,19.0825 Q387.6245,19.0825 386.9397,20.1492 Q386.2549,21.2158 386.2549,23.3159 Q386.2549,25.4077 386.9397,26.4744 Q387.6245,27.541 388.9693,27.541 Q389.6001,27.541 390.1936,27.2712 Q390.7871,27.0015 391.418,26.4204 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32.2725" x="409.4448" y="28.291">Auth</text><line style="stroke:#000000;stroke-width:0.5;" x1="221.48" x2="597.1821" y1="39" y2="39"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="228.48" y="49.7441"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148.5176" x="240.48" y="56.5352">jwtService: jwt.Service</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="228.48" y="66.2324"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="165.2109" x="240.48" y="73.0234">oidcService: oidc.Service</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="228.48" y="82.7207"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="185.2266" x="240.48" y="89.5117">authService: service.Service</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="228.48" y="99.209"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="248.1787" x="240.48" y="106">middleware: middleware.Middleware</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="228.48" y="115.6973"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="135.29" x="240.48" y="122.4883">logger: *zap.Logger</text><line style="stroke:#000000;stroke-width:0.5;" x1="221.48" x2="597.1821" y1="129.4414" y2="129.4414"/><ellipse cx="231.48" cy="143.1855" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="262.1924" x="240.48" y="146.9766">New(ctx, config, logger): (*Auth, error)</text><ellipse cx="231.48" cy="159.6738" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="309.8115" x="240.48" y="163.4648">Middleware(): func(http.Handler) http.Handler</text><ellipse cx="231.48" cy="176.1621" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="328.002" x="240.48" y="179.9531">GenerateToken(ctx, userID, roles): (string, error)</text><ellipse cx="231.48" cy="192.6504" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="351.7021" x="240.48" y="196.4414">ValidateToken(ctx, tokenString): (*jwt.Claims, error)</text><ellipse cx="231.48" cy="209.1387" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="281.1211" x="240.48" y="212.9297">IsAuthorized(ctx, operation): (bool, error)</text><ellipse cx="231.48" cy="225.627" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="176.0117" x="240.48" y="229.418">IsAdmin(ctx): (bool, error)</text><ellipse cx="231.48" cy="242.1152" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="210.0547" x="240.48" y="245.9063">HasRole(ctx, role): (bool, error)</text><ellipse cx="231.48" cy="258.6035" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="198.1123" x="240.48" y="262.3945">GetUserID(ctx): (string, error)</text><ellipse cx="231.48" cy="275.0918" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="229.1338" x="240.48" y="278.8828">GetUserRoles(ctx): ([]string, error)</text></g><!--class JWTService--><g class="entity" data-entity="JWTService" data-source-line="26" data-uid="ent0003" id="entity_JWTService"><rect fill="#FFFFFF" height="113.9531" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="244.6611" x="7" y="345.84"/><ellipse cx="89.0586" cy="361.84" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M91.5317,367.9831 Q90.9507,368.2819 90.3115,368.4313 Q89.6724,368.5807 88.9668,368.5807 Q86.46,368.5807 85.1401,366.9289 Q83.8203,365.277 83.8203,362.1559 Q83.8203,359.0265 85.1401,357.3747 Q86.46,355.7228 88.9668,355.7228 Q89.6724,355.7228 90.3198,355.8722 Q90.9673,356.0216 91.5317,356.3205 L91.5317,359.0431 Q90.9009,358.4621 90.3074,358.1923 Q89.7139,357.9225 89.083,357.9225 Q87.7383,357.9225 87.0535,358.9892 Q86.3687,360.0558 86.3687,362.1559 Q86.3687,364.2477 87.0535,365.3144 Q87.7383,366.381 89.083,366.381 Q89.7139,366.381 90.3074,366.1112 Q90.9009,365.8415 91.5317,365.2604 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="72.0439" x="109.5586" y="367.131">jwt.Service</text><line style="stroke:#000000;stroke-width:0.5;" x1="8" x2="250.6611" y1="377.84" y2="377.84"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="388.5841"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.1406" x="27" y="395.3752">config: Config</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="15" y="405.0724"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.5449" x="27" y="411.8634">logger: Logger</text><line style="stroke:#000000;stroke-width:0.5;" x1="8" x2="250.6611" y1="418.8166" y2="418.8166"/><ellipse cx="18" cy="432.5607" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="212.1055" x="27" y="436.3517">GenerateToken(): (string, error)</text><ellipse cx="18" cy="449.049" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="218.6611" x="27" y="452.84">ValidateToken(): (*Claims, error)</text></g><!--class OIDCService--><g class="entity" data-entity="OIDCService" data-source-line="33" data-uid="ent0004" id="entity_OIDCService"><rect fill="#FFFFFF" height="113.9531" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="244.6611" x="287" y="345.84"/><ellipse cx="364.8853" cy="361.84" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M367.3584,367.9831 Q366.7773,368.2819 366.1382,368.4313 Q365.499,368.5807 364.7935,368.5807 Q362.2866,368.5807 360.9668,366.9289 Q359.647,365.277 359.647,362.1559 Q359.647,359.0265 360.9668,357.3747 Q362.2866,355.7228 364.7935,355.7228 Q365.499,355.7228 366.1465,355.8722 Q366.7939,356.0216 367.3584,356.3205 L367.3584,359.0431 Q366.7275,358.4621 366.134,358.1923 Q365.5405,357.9225 364.9097,357.9225 Q363.5649,357.9225 362.8801,358.9892 Q362.1953,360.0558 362.1953,362.1559 Q362.1953,364.2477 362.8801,365.3144 Q363.5649,366.381 364.9097,366.381 Q365.5405,366.381 366.134,366.1112 Q366.7275,365.8415 367.3584,365.2604 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80.3906" x="385.3853" y="367.131">oidc.Service</text><line style="stroke:#000000;stroke-width:0.5;" x1="288" x2="530.6611" y1="377.84" y2="377.84"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="295" y="388.5841"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.1406" x="307" y="395.3752">config: Config</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="295" y="405.0724"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.5449" x="307" y="411.8634">logger: Logger</text><line style="stroke:#000000;stroke-width:0.5;" x1="288" x2="530.6611" y1="418.8166" y2="418.8166"/><ellipse cx="298" cy="432.5607" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="218.6611" x="307" y="436.3517">ValidateToken(): (*Claims, error)</text><ellipse cx="298" cy="449.049" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="213.083" x="307" y="452.84">GetUserInfo(): (*UserInfo, error)</text></g><!--class AuthService--><g class="entity" data-entity="AuthService" data-source-line="40" data-uid="ent0005" id="entity_AuthService"><rect fill="#FFFFFF" height="113.9531" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="212.0264" x="566.32" y="345.84"/><ellipse cx="618.738" cy="361.84" fill="#ADD1B2" rx="11" ry="11" style="stroke:#181818;stroke-width:1;"/><path d="M621.2111,367.9831 Q620.6301,368.2819 619.9909,368.4313 Q619.3517,368.5807 618.6462,368.5807 Q616.1393,368.5807 614.8195,366.9289 Q613.4997,365.277 613.4997,362.1559 Q613.4997,359.0265 614.8195,357.3747 Q616.1393,355.7228 618.6462,355.7228 Q619.3517,355.7228 619.9992,355.8722 Q620.6467,356.0216 621.2111,356.3205 L621.2111,359.0431 Q620.5803,358.4621 619.9867,358.1923 Q619.3932,357.9225 618.7624,357.9225 Q617.4177,357.9225 616.7328,358.9892 Q616.048,360.0558 616.048,362.1559 Q616.048,364.2477 616.7328,365.3144 Q617.4177,366.381 618.7624,366.381 Q619.3932,366.381 619.9867,366.1112 Q620.5803,365.8415 621.2111,365.2604 Z " fill="#000000"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.6904" x="639.238" y="367.131">service.Service</text><line style="stroke:#000000;stroke-width:0.5;" x1="567.32" x2="777.3464" y1="377.84" y2="377.84"/><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="574.32" y="388.5841"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="96.1406" x="586.32" y="395.3752">config: Config</text><rect fill="none" height="6" style="stroke:#C82930;stroke-width:1;" width="6" x="574.32" y="405.0724"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="99.5449" x="586.32" y="411.8634">logger: Logger</text><line style="stroke:#000000;stroke-width:0.5;" x1="567.32" x2="777.3464" y1="418.8166" y2="418.8166"/><ellipse cx="577.32" cy="432.5607" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="186.0264" x="586.32" y="436.3517">IsAuthorized(): (bool, error)</text><ellipse cx="577.32" cy="449.049" fill="#84BE84" rx="3" ry="3" style="stroke:#038048;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="155.0186" x="586.32" y="452.84">IsAdmin(): (bool, error)</text></g><!--link Auth to JWTService--><g class="link" data-entity-1="Auth" data-entity-2="JWTService" data-source-line="47" data-uid="lnk6" id="link_Auth_JWTService"><path codeLine="47" d="M256.63,286.15 C233.6,307.08 215.4596,323.554 195.8796,341.354" fill="none" id="Auth-to-JWTService" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="191.44,345.39,200.7902,342.2957,195.1397,342.0266,195.4088,336.3762,191.44,345.39" style="stroke:#000000;stroke-width:1;"/></g><!--link Auth to OIDCService--><g class="link" data-entity-1="Auth" data-entity-2="OIDCService" data-source-line="48" data-uid="lnk7" id="link_Auth_OIDCService"><path codeLine="48" d="M409.33,286.15 C409.33,307.08 409.33,321.59 409.33,339.39" fill="none" id="Auth-to-OIDCService" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="409.33,345.39,413.33,336.39,409.33,340.39,405.33,336.39,409.33,345.39" style="stroke:#000000;stroke-width:1;"/></g><!--link Auth to AuthService--><g class="link" data-entity-1="Auth" data-entity-2="AuthService" data-source-line="49" data-uid="lnk8" id="link_Auth_AuthService"><path codeLine="49" d="M552.76,286.15 C574.39,307.08 591.2876,323.4183 609.6876,341.2183" fill="none" id="Auth-to-AuthService" style="stroke:#000000;stroke-width:1;"/><polygon fill="#000000" points="614,345.39,610.3126,336.2575,610.4064,341.9135,604.7503,342.0073,614,345.39" style="stroke:#000000;stroke-width:1;"/></g><!--SRC=[dLF9JiCm4BtdAwoUsjBsm347f2vIMyGYqG87nC4aqzJKyKIsGw68VyTsqiO95Tl9ixoPURDORPZ8gAGfYJ3DK83G2_t6WUGfFmrKvULKAV8U43AYqIQHc8juZ1mbkLyp3TQECWPPs4RSW8njA2LkVTD741IPXhbUktHzyhpL2v0lB8BGoeDISJvaSNHmMgNcfIR9mQiAeGP8MHnps59f_9Kyk3o83iKnIK26fBkZsU32ASP-GgvWsuxqQy-CHgnOqYk1dP2qkvP_Zu3fJtOSkChPDe1LBgBsMkjiCAF2s6M7-9gBc880IJKiSGEYA9IR9kQJ7f78GTawIaicabgXEyfPN0_JLbmug2DdfpZcbAMg5ZbNbZLAjeEu2CJCCc0eRDWJ8c_YuvIv6aVzCwfk3D4YbQLy53K5VUlQskSvqbE9iTdK7lRms00URgVbNKcBK4NExvUbMfvKiR2GZDrRMxAtt_e2VZLkDzx6Q2jU_e4wOjVpoVW_p7ukwazMhB30xBKZr1g_mx4RLj_dJ-ngT_JjvNnn6aBkv_VxPzxMAfitiCheyGm-0G00]--></g></svg>